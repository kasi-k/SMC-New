import{j as e,q as L,s as A,r as i,u as $,b as U,c as w,t as S,v as O,D as G}from"./index-BCH8vSHg.js";import{P as J,C as R,a as V,E as q,b as Y,u as N,w as B}from"./jspdf.plugin.autotable-DMUtcjWj.js";import{F as H}from"./index-DDiz-UEL.js";import"./typeof-QjJsDpFa.js";const K=({totalItems:o,itemsPerPage:p,onPageChange:b,currentPage:l})=>{const a=Math.ceil(o/p),d=`Showing ${l} out of ${a} results`,m=t=>{t>0&&t<=a&&b(t)},h=()=>{const t=[];if(a<=4)for(let n=1;n<=a;n++)t.push(n);else t.push(1),l===1||l===2?(t.push(2),t.push(3)):l===a||l===a-1?(t.push(a-2),t.push(a-1)):(t.push(l-1),t.push(l)),t.includes(a)||t.push(a);return t};return e.jsxs("div",{className:"flex justify-between items-center mt-3 px-3 ",children:[e.jsx("div",{className:"text-sm text-gray-600",children:e.jsx("p",{className:"text-base",children:d})}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("button",{className:"flex items-center gap-2 text-orange px-4 py-2 rounded-l-md",onClick:()=>m(l-1),disabled:l===1,children:[e.jsx(L,{})," Previous"]}),h().map((t,n)=>t==="..."?e.jsx("span",{className:"px-4 py-2",children:"..."},n):e.jsx("button",{className:`px-3 py-1.5 text-sm rounded-md ${l===t?" bg-gradient-to-b from-[#3D03FA] to-[#A71CD2] px-3 py-1 font-medium ":""}`,onClick:()=>m(t),children:t},n)),e.jsxs("button",{className:"flex items-center gap-2 text-orange pl-4 py-2 rounded-r-md",onClick:()=>m(l+1),disabled:l===a,children:["Next ",e.jsx(A,{})]})]})]})},ee=({permissions:o})=>{o==null||o.includes("create");const p=o==null?void 0:o.includes("view"),b=o==null?void 0:o.includes("delete"),[l,a]=i.useState(1),[d,m]=i.useState([]),[h,t]=i.useState([]),[n,u]=i.useState(!1),[v,D]=i.useState(""),T=$();i.useEffect(()=>{E()},[n]);const j=10;i.useEffect(()=>{const s=(l-1)*j,r=d.slice(s,s+j);t(r)},[l,d]);const E=async()=>{try{const r=(await U.get(`${w}/api/getcourses`)).data;m(r)}catch(s){console.log(s)}},_=s=>{D(`${w}/api/deletecourse/${s}`),u(!0)},k=()=>{u(!1)},I=s=>{a(s)},f=()=>d.map(s=>({"User Id":s._id,"First Name":s.fname,"Last Name":s.lname,Email:s.email,Phone:s.phone,Topic:s.mainTopic,Type:s.type,Date:S(s.date)})),F=()=>{const s=N.json_to_sheet(f()),r=[{wpx:180},{wpx:100},{wpx:100},{wpx:180},{wpx:80},{wpx:80},{wpx:120},{wpx:100}];s["!cols"]=r;const x=N.book_new();N.book_append_sheet(x,s,"courses"),B(x,"SMC_courses.xlsx")},z=()=>{const s=new Y,r=["User Id","First Name","Last Name","Email","Phone","Topic","Type","Date"],x=f().map(c=>[c["User Id"],c["First Name"],c["Last Name"],c.Email,c.Phone,c.Topic,c.Type,c.Date]);s.autoTable({head:[r],body:x,startY:20,theme:"grid",headStyles:{fillColor:[97,144,213],textColor:[255,255,255],fontStyle:"bold",halign:"center"},bodyStyles:{textColor:[0,0,0],halign:"center"}}),s.save("SMC_courses.pdf")},M=(s,r,x,c,g,P)=>{const y=JSON.parse(s);localStorage.setItem("courseId",c),localStorage.setItem("first",g),localStorage.setItem("jsonData",JSON.stringify(y));let C="";g&&(C=P),T("/content",{state:{jsonData:y,mainTopic:r.toUpperCase(),type:x.toLowerCase(),courseId:c,end:C}})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:" font-extralight",children:[e.jsxs("div",{className:"flex justify-between items-center my-2",children:[e.jsx("p",{className:" mx-2 mt-6",children:"Courses"}),e.jsxs("div",{className:" mx-2 flex gap-6 mt-4",children:[e.jsx("button",{onClick:z,children:e.jsx("img",{className:"size-8",src:J,alt:"Pdf image"})}),e.jsx(R,{data:f(),filename:"SMC_courses.csv",className:"cursor-pointer",target:"_blank",children:e.jsx("img",{className:"size-8",src:V,alt:"csv image"})}),e.jsx("button",{onClick:F,children:e.jsx("img",{className:"size-8 ",src:q,alt:"excel image"})})]})]}),e.jsx("div",{className:"mx-1 overflow-auto no-scrollbar  ",children:e.jsxs("table",{className:" w-full",children:[e.jsx("thead",{className:"text-slate-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 font-extralight border border-slate-400",children:"User Id"}),e.jsx("th",{className:"font-extralight border border-slate-400 text-nowrap",children:"First Name"}),e.jsx("th",{className:"font-extralight border border-slate-400 text-nowrap",children:"Last Name"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Email"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Phone"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Topic"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Type"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Date"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Action"})]})}),e.jsx("tbody",{className:"text-slate-400 ",children:h&&h.map((s,r)=>e.jsxs("tr",{className:" text-nowrap text-center",children:[e.jsx("td",{className:"border border-slate-400",children:s._id}),e.jsx("td",{className:"border border-slate-400 capitalize",children:s.fname}),e.jsx("td",{className:"border border-slate-400 capitalize",children:s.lname}),e.jsx("td",{className:"border border-slate-400",children:s.email}),e.jsx("td",{className:"border border-slate-400",children:s.phone}),e.jsx("td",{className:"border border-slate-400  capitalize",children:s.mainTopic}),e.jsxs("td",{className:"border border-slate-400 capitalize",children:[" ",s.type]}),e.jsx("td",{className:"border border-slate-400 text-slate-500 ",children:S(s.date)}),e.jsxs("td",{className:" border-b border-r border-slate-400 flex items-center justify-evenly  ",children:[p&&e.jsx("p",{onClick:()=>M(s.content,s.mainTopic,s.type,s._id,s.completed,s.end),className:" cursor-pointer p-2  text-green-600 ",children:e.jsx(H,{size:24})}),b&&e.jsx("p",{onClick:()=>_(s._id),className:"cursor-pointer size-6",children:e.jsx("img",{src:O,alt:"delete image"})})]})]},r))})]})})]}),e.jsx(K,{totalItems:d.length,itemsPerPage:j,currentPage:l,onPageChange:I}),n&&e.jsx(G,{onClose:k,title:"Course",onDelete:v})]})};export{ee as default};
