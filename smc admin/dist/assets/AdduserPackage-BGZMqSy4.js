import{r as c,u as v,a as S,b as k,c as h,j as e,F as w,A,B as E,o as C,d as U,e as f}from"./index-BU4j0FDF.js";import{b as D}from"./index-Ci4eohfX.js";const F=U().shape({packagename:f().required("Package name is required").notOneOf([""],"Please select a package"),email:f().email().required("Email is required")}),I=`Package name,User Email Id
Pro ,user@gmail.com`,L=()=>{var u,x;const[n,$]=c.useState(!1),[l,o]=c.useState([]),[i,d]=c.useState(!1),[q,j]=c.useState(null),m=v();c.useEffect(()=>{y()},[]);const{register:p,handleSubmit:b,formState:{errors:g}}=S({resolver:C(F)}),N=async a=>{console.log(a);const s=l.find(t=>t.packagename===a.packagename);if(s){const t={...a,course:s.course};localStorage.setItem("plan",a.packagename),localStorage.setItem("courses",s.course);try{const r=await k.post(`${h}/api/addusertoplan`,t);m("/packages")}catch(r){console.log(r)}}else console.error("Package not found.")},y=async()=>{try{const a=await k.get(`${h}/api/getsubscriptionplan`);Array.isArray(a.data.plans)?o(a.data.plans):(console.error("Expected an array of package options, but got:",a.data),o([]))}catch(a){console.error("Error fetching taxes:",a)}},P=a=>{const s=a.target.value,t=l.find(r=>r.packagename===s);j(t)};return e.jsxs(e.Fragment,{children:[i===!1&&e.jsxs("div",{className:"mx-6 my-4 font-poppins h-full",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"mb-2 mx-2 mt-4",children:"Add a user to package"}),e.jsxs("p",{onClick:()=>d(!0),className:" cursor-pointer flex  items-center gap-2 bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] px-4 py-1 rounded-md",children:[e.jsx(D,{}),"Bulk Upload Users"]})]}),e.jsxs("form",{onSubmit:b(N),className:"mx-4 my-6   ",children:[e.jsxs("div",{className:"grid gap-2.5 ",children:[e.jsxs("label",{className:"col-span-12 ",children:["Package Name ",e.jsx("span",{className:" text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative inline-block col-span-2 ",children:[e.jsxs("select",{...p("packagename"),defaultValue:"",className:" w-full bg-white  text-black px-2 py-2 outline-none rounded-md ",onChange:P,children:[e.jsx("option",{value:"",disabled:!0,children:"Select Package"}),l&&l.map((a,s)=>e.jsx("option",{value:a.packagename,children:a.packagename},s))]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-5 bg-gray-100 px-4 rounded-lg pointer-events-none outline-none",children:e.jsx(w,{className:"text-black text-2xl"})}),e.jsx("p",{className:"text-red-700 col-span-12 ",children:(u=g.packagename)==null?void 0:u.message})]}),e.jsxs("label",{className:"col-span-12 ",children:["User Email ID ",e.jsx("span",{className:" text-red-600",children:"*"})]}),e.jsx("input",{...p("email"),type:"email",placeholder:"Enter user Email-Id",className:" col-span-2 bg-white  text-black px-2 py-1.5 outline-none rounded-md "}),e.jsx("p",{className:"text-red-700 col-span-12 ",children:(x=g.email)==null?void 0:x.message})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsx("button",{type:"submit",className:`my-6 cursor-pointer text-white bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] px-8 py-1.5 rounded-md ${n?"opacity-50 cursor-not-allowed":""}`,disabled:n,children:n?e.jsxs("div",{className:"flex text-xl gap-2",children:[e.jsx(A,{className:"h-6 w-6 animate-spin"}),e.jsx("p",{children:"Saving...."})]}):"Save"}),e.jsx("p",{onClick:()=>m("/packages"),className:" cursor-pointer text-black bg-white  py-1.5 px-4 rounded-md ",children:"Cancel"})]})]})]}),i===!0&&e.jsx(E,{onClose:()=>d(!1),title:"Users to Packages",sampleData:I,filename:"UserPackage Sample"})]})};export{L as default};
