import{r,u as y,a as v,b as x,c as u,j as e,F as P,A as S,o as w,d as A,e as h}from"./index-BCH8vSHg.js";import{b as E}from"./index-dDIeid9a.js";const C=A().shape({packagename:h().required("Package name is required").notOneOf([""],"Please select a package"),email:h().email().required("Email is required")}),q=()=>{var p,g;const[l,D]=r.useState(!1),[c,o]=r.useState([]),[F,k]=r.useState(null),i=y();r.useEffect(()=>{b()},[]);const{register:d,handleSubmit:f,formState:{errors:m}}=v({resolver:w(C)}),j=async a=>{console.log(a);const s=c.find(t=>t.packagename===a.packagename);if(s){const t={...a,course:s.course};localStorage.setItem("plan",a.packagename),localStorage.setItem("courses",s.course);try{const n=await x.post(`${u}/api/addusertoplan`,t);i("/packages")}catch(n){console.log(n)}}else console.error("Package not found.")},b=async()=>{try{const a=await x.get(`${u}/api/getsubscriptionplan`);Array.isArray(a.data.plans)?o(a.data.plans):(console.error("Expected an array of package options, but got:",a.data),o([]))}catch(a){console.error("Error fetching taxes:",a)}},N=a=>{const s=a.target.value,t=c.find(n=>n.packagename===s);k(t)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-6 my-4 font-poppins h-full",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"mb-2 mx-2 mt-4",children:"Add a user to package"}),e.jsxs("p",{className:" cursor-pointer flex  items-center gap-2 bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] px-4 py-1 rounded-md",children:[e.jsx(E,{}),"Bulk Upload Users"]})]}),e.jsxs("form",{onSubmit:f(j),className:"mx-4 my-6   ",children:[e.jsxs("div",{className:"grid gap-2.5 ",children:[e.jsxs("label",{className:"col-span-12 ",children:["Package Name ",e.jsx("span",{className:" text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative inline-block col-span-2 ",children:[e.jsxs("select",{...d("packagename"),defaultValue:"",className:" w-full bg-white  text-black px-2 py-2 outline-none rounded-md ",onChange:N,children:[e.jsx("option",{value:"",disabled:!0,children:"Select Package"}),c&&c.map((a,s)=>e.jsx("option",{value:a.packagename,children:a.packagename},s))]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-5 bg-gray-100 px-4 rounded-lg pointer-events-none outline-none",children:e.jsx(P,{className:"text-black text-2xl"})}),e.jsx("p",{className:"text-red-700 col-span-12 ",children:(p=m.packagename)==null?void 0:p.message})]}),e.jsxs("label",{className:"col-span-12 ",children:["User Email ID ",e.jsx("span",{className:" text-red-600",children:"*"})]}),e.jsx("input",{...d("email"),type:"email",placeholder:"Enter user Email-Id",className:" col-span-2 bg-white  text-black px-2 py-1.5 outline-none rounded-md "}),e.jsx("p",{className:"text-red-700 col-span-12 ",children:(g=m.email)==null?void 0:g.message})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsx("button",{type:"submit",className:`my-6 cursor-pointer text-white bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] px-8 py-1.5 rounded-md ${l?"opacity-50 cursor-not-allowed":""}`,disabled:l,children:l?e.jsxs("div",{className:"flex text-xl gap-2",children:[e.jsx(S,{className:"h-6 w-6 animate-spin"}),e.jsx("p",{children:"Saving...."})]}):"Save"}),e.jsx("p",{onClick:()=>i("/packages"),className:" cursor-pointer text-black bg-white  py-1.5 px-4 rounded-md ",children:"Cancel"})]})]})]})})};export{q as default};
