import{r as o,n as q,j as e,M as z,y as g,b as h,c as u,u as R,a as T,p as V,o as O,d as _,e as d}from"./index-BCH8vSHg.js";const G=({CloseProfileModal:t})=>{var w;const[x,v]=o.useState(null),[p,D]=o.useState(""),[j,r]=o.useState(""),f=(w=q().state)==null?void 0:w.userId,N=m=>{const a=m.target.files[0];if(!a){alert("Please select a file!");return}const y=2*1024*1024;if(a.size>y){g.error("File size exceeds 2MB!");return}v(a);const l=new FileReader;l.onload=()=>{const i=l.result;D(i),r(i)},l.readAsDataURL(a)},b=async()=>{if(!x){g.error("No file selected!");return}const m={name:x.name,user:f,image:p};try{(await h.post(`${u}/api/images`,m)).status===200?(g.success("Profile Image Updated Succesfully"),t()):g.error("Failed to Upload")}catch(a){console.log(a)}};return e.jsx(z,{children:e.jsxs("div",{className:"w-[530px] min-h-[330px] my-3 mx-8 font-extralight font-poppins",children:[e.jsx("p",{className:"text-end text-2xl font-medium",onClick:()=>t(),children:"x"}),e.jsx("p",{className:"mx-16 text-xl my-3",children:"Choose Profile Image"}),e.jsx("div",{className:"relative w-2/3 mx-20",children:e.jsxs("div",{className:"border bg-white rounded-lg py-1.5 my-1 ",children:[e.jsx("div",{className:"absolute inset-y-0  left-0 rounded-lg px-2 py-5 flex items-center  bg-gray-300  pointer-events-none outline-none text-black",children:"Choose Files"}),e.jsx("input",{accept:".jpg,.jpeg,.png,.gif",type:"file",className:"opacity-0 w-28 text-black ",id:"file-input",onChange:N}),e.jsx("span",{className:"absolute top-5 -translate-y-1/2 lg:right-2 md:right-4 right-16 text-normal text-black ",id:"file-name",children:"No Files Chosen"})]})}),j&&e.jsxs("div",{className:"text-center text-lg my-2",children:[e.jsx("p",{className:"text-center text-xl my-2",children:"Preview "}),e.jsx("img",{src:j,alt:"Preview",className:"w-60 mx-auto"})]}),e.jsx("div",{className:"flex justify-center my-8",children:e.jsx("button",{className:" font-normal   bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] text-center w-36 py-2.5 my-2 ",onClick:b,children:"Change Image"})})]})})},H=_().shape({fname:d().trim().required("First name is required").transform(t=>t.toLowerCase()),lname:d().required("Last name is required").transform(t=>t.toLowerCase()),email:d().email("Please Enter a valid Email").trim().required("Email is required"),phone:d().required("Please enter mob.no"),dob:d().required("Please enter Date of birth"),designation:d().required("Please select Designation")}),K=()=>{var C,P,I,F,E,A,$;const[t,x]=o.useState(!1),p=(C=q().state)==null?void 0:C.userId,[D,j]=o.useState({}),[r,S]=o.useState({}),[f,N]=o.useState([]),[b,w]=o.useState(null),m=R();o.useEffect(()=>{B(),U(),k()},[t]);const{register:a,handleSubmit:y,setValue:l,formState:{errors:i}}=T({resolver:O(H)}),U=async()=>{try{const s=await h.get(`${u}/api/getadminbyid/${p}`),c=s.data.user;j(c);const n=s.data.user;l("fname",n.fname),l("lname",n.lname),l("dob",n.dob),l("email",n.email),w(n.email),l("phone",n.phone),l("designation",n.designation)}catch(s){console.log(s)}},k=async()=>{try{const c=(await h.get(`${u}/api/getimagebyid?user=${p}`)).data.user;S(c)}catch(s){console.log(s)}},L=()=>{x(!t)},M=async s=>{const c={...s};try{(await h.put(`${u}/api/adminupdate/${p}`,c)).status===200&&(g.success("Admin Updated Successfully"),m("/team"))}catch(n){console.error("Error updating category:",n)}},B=async()=>{try{const s=await h.get(`${u}/api/getroles`);Array.isArray(s.data.role)?N(s.data.role):(console.error("Expected an array of tax options, but got:",s.data),N([]))}catch(s){console.error("Error fetching taxes:",s)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-extralight my-4",children:[e.jsx("p",{className:" mx-2 text-lg ",children:"Edit Team"}),e.jsx("hr",{}),e.jsxs("div",{className:"mx-2 my-4 space-y-1",children:[e.jsx("button",{onClick:()=>m("/changepassword",{state:{adminemail:b}}),className:" float-end bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] px-5 py-2",children:"Change Password"}),e.jsxs("div",{className:"mx-10 ",children:[e.jsx("img",{src:r!=null&&r.image?r.image:V,alt:"Profile",className:`w-40 h-40 ${r!=null&&r.image?" rounded-3xl object-cover":""}`}),e.jsx("button",{className:" text-base  bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] lg:w-40 md:w-40 w-40 py-2.5 my-5 ",onClick:()=>x(!0),children:"Change Image"})]})]}),e.jsx("form",{onSubmit:y(M),children:e.jsxs("div",{className:"mx-2 ",children:[e.jsx("p",{className:"my-2",children:"Personal Information"}),e.jsx("hr",{}),e.jsxs("div",{className:"grid lg:grid-cols-12 my-6 mx-4 gap-4 text-slate-400",children:[e.jsxs("div",{className:"col-span-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"mb-7 ",children:"First Name"}),e.jsx("input",{type:"text",id:"fname",className:" outline-none bg-transparent lg:w-2/3 md:w-1/2 w-28 px-2",...a("fname")}),e.jsx("p",{className:"text-red-700",children:(P=i.fname)==null?void 0:P.message})]}),e.jsx("hr",{className:"lg:w-2/3 md:w-1/2 w-20"})]}),e.jsxs("div",{className:"col-span-3 ",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"mb-7 ",children:"Last Name"}),e.jsx("input",{type:"text",id:"lname",className:" outline-none bg-transparent lg:w-2/3 md:w-1/2 w-28 px-2 ",...a("lname")}),e.jsx("p",{className:"text-red-700",children:(I=i.lname)==null?void 0:I.message})]}),e.jsx("hr",{className:"lg:w-2/3 md:w-1/2 w-20"})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"mb-6 ",children:"Date Of Birth"}),e.jsx("input",{type:"date",className:"outline-none bg-transparent lg:w-2/3 md:w-1/2 w-28 ",...a("dob")}),e.jsx("p",{className:"text-red-700",children:(F=i.dob)==null?void 0:F.message})]}),e.jsx("hr",{className:"lg:w-2/3 md:w-1/2 w-28"})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"mb-3 ",children:"Designation"}),e.jsxs("select",{...a("designation"),defaultValue:"select",className:" w-2/3 outline-none  rounded-md py-1.5 px-2  bg-transparent",children:[e.jsx("option",{value:"select",disabled:!0,children:"Select Designation"}),f&&f.map((s,c)=>e.jsx("option",{value:s.designation,children:s.role_name},c))]}),e.jsx("p",{className:"text-red-700",children:(E=i.designation)==null?void 0:E.message})]}),e.jsx("hr",{className:"lg:w-2/3 md:w-1/2 w-28"})]})]}),e.jsx("p",{className:"my-2",children:"Contact Information"}),e.jsx("hr",{}),e.jsxs("div",{className:"font-extralight grid lg:grid-cols-3 mx-2 my-8 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"mb-6",children:"Email"}),e.jsx("input",{type:"email",id:"email",className:" bg-transparent outline-none lg:w-54 md:w-56 w-48 px-2",...a("email")}),e.jsx("p",{className:"text-red-700",children:(A=i.email)==null?void 0:A.message})]}),e.jsx("hr",{className:"lg:w-54 md:w-56 w-48 mb-6"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"mb-6",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",id:"phone",className:"bg-transparent  outline-none lg:w-1/2 md:w-56 w-48 px-2",...a("phone")}),e.jsx("p",{className:"text-red-700",children:($=i.phone)==null?void 0:$.message})]}),e.jsx("hr",{className:"lg:w-1/2 md:w-56 w-48 mb-6"})]})]}),e.jsx("button",{type:"submit",className:" mx-2 bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] px-16 py-2",children:"Save"})]})})]}),t&&e.jsx(G,{CloseProfileModal:L})]})};export{K as default};
