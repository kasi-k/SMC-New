import{r,u as H,b as y,c as x,j as e,t as S,v as J,w as K,D as W,y as m}from"./index-74p-botU.js";import{P as X,C as Z,a as ee,E as te,b as se,u,w as ae}from"./jspdf.plugin.autotable-7yQRCdnt.js";import{E as le}from"./pencil-DAlNEmyY.js";import"./typeof-QjJsDpFa.js";const re=`si,fname,email,lname,phone,dob,type,company
1,john,user20@gmail.com,doe,9784561230,11-25-2024,free,seenit`,he=({permissions:s})=>{const P=s==null?void 0:s.includes("create"),k=s==null?void 0:s.includes("edit"),D=s==null?void 0:s.includes("delete");s==null||s.includes("download"),s==null||s.includes("view");const[c,U]=r.useState([]),[h,p]=r.useState(!1),[v,E]=r.useState(""),[I,b]=r.useState(null),[f,g]=r.useState("Bulk Upload"),n=r.useRef(null);localStorage.getItem("plan"),localStorage.getItem("courses");const[j,N]=r.useState(1),[F,oe]=r.useState(""),[_,L]=r.useState(8),[d,ce]=r.useState(1),[B,ne]=r.useState(0),[M,de]=r.useState([]),w=H();r.useEffect(()=>{C()},[h]);const C=async()=>{try{const a=(await y.get(`${x}/api/getusers`)).data.user;U(a)}catch(t){console.log(t)}};c.filter(t=>t.fname.toLowerCase().includes(F.toLowerCase()));const T=t=>{E(`${x}/api/deleteuser?id=${t}`),p(!0)},A=()=>{p(!1)},z=()=>{w("/adduser")},O=t=>{b(t.target.files[0]),g("Upload")},R=()=>{f==="Bulk Upload"?n.current&&n.current.click():$(I)},$=async t=>{try{const a=new FormData;a.append("file",t),(await y.post(`${x}/api/useruploadcsv`,a,{headers:{"Content-Type":"multipart/form-data"}})).status===200?(m.success("File uploaded successfully"),g("Bulk Upload"),b(null),C(),m.success("Data Uploaded Successfully")):m.error("Data failed to Upload")}catch(a){console.log(a)}},V=t=>{const a=new Blob([t],{type:"text/csv"}),o=URL.createObjectURL(a),l=document.createElement("a");l.href=o,l.download="bulkupload_template.csv",l.click(),URL.revokeObjectURL(o)},Q=()=>{V(re)},i=()=>c.map(t=>({"User Id":t._id,"First Name":t.fname,"Last Name":t.lname,Email:t.email,Phone:t.phone,DOB:S(t.dob),Plan:t.type})),Y=()=>{const t=u.json_to_sheet(i()),a=[{wpx:100},{wpx:100},{wpx:100},{wpx:180},{wpx:100},{wpx:80},{wpx:80},{wpx:80},{wpx:100}];t["!cols"]=a;const o=u.book_new();u.book_append_sheet(o,t,"Users"),ae(o,"SMC_users.xlsx")},q=()=>{const t=new se,a=["User Id","First Name","Last Name","Email","Phone","DOB","Plan","Courses","Subscription Date"],o=i().map(l=>[l["User Id"],l["First Name"],l["Last Name"],l.Email,l.Phone,l.DOB,l.Plan,l.Courses,l["Subscription Date"]]);t.autoTable({head:[a],body:o,startY:20,theme:"grid",headStyles:{fillColor:[97,144,213],textColor:[255,255,255],fontStyle:"bold",halign:"center"},bodyStyles:{textColor:[0,0,0],halign:"center"}}),t.save("SMC_users.pdf")},G=t=>{t>0&&t<=d&&N(t)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mx-2 font-poppins h-full",children:[e.jsxs("div",{className:"flex justify-between items-center my-2 ",children:[e.jsx("p",{className:"mx-2 mt-6",children:"User"}),e.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[e.jsx("button",{onClick:q,children:e.jsx("img",{className:"size-8",src:X,alt:"Pdf image"})}),e.jsx(Z,{data:i(),filename:"SMC_users.csv",className:"cursor-pointer",target:"_blank",children:e.jsx("img",{className:"size-8",src:ee,alt:"csv image"})}),e.jsx("button",{onClick:Y,children:e.jsx("img",{className:"size-8",src:te,alt:"excel image"})}),e.jsxs("div",{className:"flex mx-3 space-x-6",children:[e.jsx("button",{onClick:Q,className:" cursor-pointer  rounded-md bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] text-nowrap py-1 lg:px-4 md:px-4 px-1",children:"CSV Template"}),e.jsxs("button",{onClick:R,className:" cursor-pointer  rounded-md bg-white text-nowrap text-black py-1 lg:px-4 md:px-4 px-1",children:[f,e.jsx("input",{type:"file",ref:n,onChange:O,className:"hidden"})]}),P&&e.jsx("button",{onClick:z,className:" cursor-pointer  rounded-md bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] text-nowrap py-1 lg:px-4 md:px-4 px-1",children:"Add user"})]})]})]}),e.jsx("div",{className:"mx-1 overflow-auto no-scrollbar ",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"text-nowrap text-slate-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 font-extralight border border-slate-400",children:"User Id"}),e.jsx("th",{className:"font-extralight border border-slate-400 text-nowrap",children:"First Name"}),e.jsx("th",{className:"font-extralight border border-slate-400 text-nowrap",children:"Last Name"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Email"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Phone"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"DOB"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Plan"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Action"})]})}),e.jsx("tbody",{className:"text-slate-400 ",children:c&&c.map((t,a)=>e.jsxs("tr",{className:"text-nowrap text-center",children:[e.jsx("td",{className:"border border-slate-400",children:t._id}),e.jsx("td",{className:"border border-slate-400 capitalize",children:t.fname}),e.jsx("td",{className:"border border-slate-400 capitalize",children:t.lname}),e.jsx("td",{className:"border border-slate-400",children:t.email}),e.jsx("td",{className:"border border-slate-400",children:t.phone}),e.jsx("td",{className:"border border-slate-400",children:S(t.dob)}),e.jsx("td",{className:"border border-slate-400",children:t.type}),e.jsxs("td",{className:"border-b border-r border-slate-400 flex justify-around items-center",children:[k&&e.jsx("p",{onClick:()=>w("/edituser",{state:{userId:t._id}}),className:"cursor-pointer mx-1 p-1 text-green-600",children:e.jsx("img",{className:"size-6",src:le,alt:"edit image"})}),D&&e.jsx("p",{onClick:()=>{T(t._id)},className:"cursor-pointer",children:e.jsx("img",{className:"size-6 my-1",src:J,alt:"delete image"})})]})]},a))})]})})]}),e.jsx(K,{Length:M.length,currentPage:j,totalPages:d,totalItems:B,paginate:G,hasNextPage:j<d,setItemsPerPage:L,setCurrentPage:N,itemsPerPage:_}),h&&e.jsx(W,{onClose:A,title:"user",onDelete:v})]})};export{he as default};
