import{r as a,u as R,b as y,c as n,j as e,x as C,t as P,z as G,C as q,H,D as V,B as J,y as o}from"./index-DgKZBfYf.js";import{C as K,a as W,E as X,u as i,w as Y}from"./jspdf.plugin.autotable-lZWRLWXJ.js";const Z=`id,status,fname,email,lname,phone,dob,type,company,coursegenerated,pregeneratecourses,quizattempted,studygroups
1,Active,john,user@gmail.com,doe,9784561230,11-25-2024,free,seenit,1,1,10,1`,ce=({permissions:s})=>{const S=s==null?void 0:s.includes("create"),U=s==null?void 0:s.includes("edit"),D=s==null?void 0:s.includes("delete");s==null||s.includes("download"),s==null||s.includes("view");const[l,k]=a.useState([]),[x,u]=a.useState(!1),[v,B]=a.useState(""),[c,h]=a.useState(null),[ee,I]=a.useState("Bulk Upload");a.useRef(null),localStorage.getItem("plan"),localStorage.getItem("courses");const[m,b]=a.useState(1),[_,te]=a.useState(""),[E,z]=a.useState(8),[d,se]=a.useState(1),[F,ae]=a.useState(0),[A,re]=a.useState([]),[p,f]=a.useState(!1),j=R();a.useEffect(()=>{g()},[x]);const g=async()=>{try{const r=(await y.get(`${n}/api/getusers`)).data.user;k(r)}catch(t){console.log(t)}};l.filter(t=>t.fname.toLowerCase().includes(_.toLowerCase()));const M=t=>{B(`${n}/api/deleteuser?id=${t}`),u(!0)},L=()=>{u(!1)},T=()=>{j("/adduser")},$=async()=>{if(!c){o.error("Please select a file to upload.");return}try{const t=new FormData;t.append("file",c),(await y.post(`${n}/api/useruploadcsv`,t,{headers:{"Content-Type":"multipart/form-data"}})).status===200?(o.success("File uploaded successfully"),I("Bulk Upload"),h(null),g()):o.error("Data failed to Upload")}catch(t){o.error("Upload failed!"),console.log(t)}},N=()=>l.map(t=>({"User Id":t._id,"First Name":t.fname,"Last Name":t.lname,Email:t.email,Phone:t.phone,DOB:P(t.dob),Plan:t.type})),O=()=>{const t=i.json_to_sheet(N()),r=[{wpx:100},{wpx:100},{wpx:100},{wpx:180},{wpx:100},{wpx:80},{wpx:80},{wpx:80},{wpx:100}];t["!cols"]=r;const w=i.book_new();i.book_append_sheet(w,t,"Users"),Y(w,"SMC_users.xlsx")},Q=t=>{t>0&&t<=d&&b(t)};return e.jsxs(e.Fragment,{children:[p===!1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mx-2 mt-8 font-poppins h-full",children:[e.jsxs("div",{className:"flex justify-end gap-2",children:[S&&e.jsxs("button",{onClick:T,className:" flex items-center gap-2 cursor-pointer  rounded bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] text-nowrap py-1 lg:px-4 md:px-4 px-1",children:[e.jsx(C,{})," Add user"]}),e.jsxs("p",{onClick:()=>f(!0),className:" cursor-pointer flex items-center gap-2 bg-white text-black rounded py-1 px-4",children:[e.jsx(C,{}),"Bulk Upload users"]})]}),e.jsxs("div",{className:"flex justify-between items-center my-2 ",children:[e.jsx("p",{className:"mx-2 mt-6",children:"User"}),e.jsxs("div",{className:"flex  items-center gap-3 mt-4",children:[e.jsx(K,{data:N(),filename:"SMC_users.csv",className:"cursor-pointer",target:"_blank",children:e.jsx("img",{className:"size-8",src:W,alt:"csv image"})}),e.jsx("button",{onClick:O,children:e.jsx("img",{className:"size-8",src:X,alt:"excel image"})})]})]}),e.jsx("div",{className:"mx-1 overflow-auto no-scrollbar ",children:e.jsxs("table",{className:"w-full ",children:[e.jsx("thead",{className:"font-semibold   text-black  bg-cyan-300 ",children:e.jsxs("tr",{children:[e.jsx("th",{className:" font-extralight border border-slate-400",children:"Id"}),e.jsx("th",{className:"font-extralight border border-slate-400 text-nowrap",children:"First Name"}),e.jsx("th",{className:"font-extralight border border-slate-400 text-nowrap",children:"Last Name"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Email"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Phone"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"DOB"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Plan"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Courses Generated"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Pregenerated Courses"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Quizzes Attempted"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Study Groups"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white text-black ",children:l&&l.map((t,r)=>e.jsxs("tr",{className:"text-nowrap text-center",children:[e.jsx("td",{className:"p-2 border border-slate-400",children:t._id}),e.jsx("td",{className:"border border-slate-400 capitalize",children:t.fname}),e.jsx("td",{className:"border border-slate-400 capitalize",children:t.lname}),e.jsx("td",{className:"border border-slate-400",children:t.email}),e.jsx("td",{className:"border border-slate-400",children:t.phone}),e.jsx("td",{className:"border border-slate-400",children:P(t.dob)}),e.jsx("td",{className:"border border-slate-400",children:t.type}),e.jsx("td",{className:"border border-slate-400",children:"0"}),e.jsx("td",{className:"border border-slate-400",children:"0"}),e.jsx("td",{className:"border border-slate-400",children:"0"}),e.jsx("td",{className:"border border-slate-400",children:"0"}),e.jsxs("td",{className:"border-b border-r border-slate-400 flex items-center justify-around p-2.5 gap-2",children:[U&&e.jsx("p",{onClick:()=>j("/edituser",{state:{userId:t._id}}),className:"cursor-pointer  text-cyan-300",children:e.jsx(G,{size:22})}),D&&e.jsx("p",{onClick:()=>{M(t._id)},className:"cursor-pointer text-red-500",children:e.jsx(q,{size:22})})]})]},r))})]})})]}),e.jsx(H,{Length:A.length,currentPage:m,totalPages:d,totalItems:F,paginate:Q,hasNextPage:m<d,setItemsPerPage:z,setCurrentPage:b,itemsPerPage:E}),x&&e.jsx(V,{onClose:L,title:"user",onDelete:v})]}),p===!0&&e.jsx(J,{onClose:()=>f(!1),title:"Users",sampleData:Z,onUpload:$,filename:"Userdata",setFile:h,file:c})]})};export{ce as default};
