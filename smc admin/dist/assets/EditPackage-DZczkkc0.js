import{r as g,u as J,n as K,a as W,b as v,c as f,y as k,j as e,A as X,o as Z,F as _,d as ee,e as o,l as F}from"./index-SrRR53CN.js";const ae=ee().shape({razorpay:o().trim().required("Razorpay ID is required"),packagename:o().trim().required("Package name is required"),duration:o().trim().required("Plan Duration is required"),inr:F().required("Price in INR required"),course:o().trim().required("Courses are required"),tax:F().required("Tax is required"),subtopic:o().oneOf(["5","10"],"Please select a valid number of subtopics").required("Please select the number of subtopics"),coursetype:o().oneOf(["Text & Image Course","Video & Text Course"],"Please select a valid course type").required("Please select the course type"),preGenerated:o().oneOf(["Yes","No"],"Please select Yes or No for Pre-Generated Courses").required("Pre-Generated Courses selection is required"),studyGroup:o().oneOf(["Yes","No"],"Please select Yes or No for Study Group").required("Study Group selection is required"),quizAccess:o().oneOf(["Yes","No"],"Please select Yes or No for Quiz Access").required("Quiz Access selection is required")}),y=({label:d,register:p,name:t,type:n="text",error:m,...l})=>e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("label",{className:"text-lg",children:[d," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{...p(t),type:n,className:"bg-white outline-none text-black rounded-md py-1.5 px-2",...l}),e.jsx("p",{className:"text-red-700",children:m})]}),R=({label:d,register:p,name:t,options:n,error:m})=>e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("label",{className:"text-lg",children:[d," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative ",children:[e.jsxs("select",{defaultValue:"",...p(t),className:"w-full bg-white outline-none text-black rounded-md py-2 px-2",children:[e.jsxs("option",{value:"",disabled:!0,children:["Select ",d]}),n.map((l,c)=>e.jsx("option",{value:l.value,children:l.label},c))]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-5 bg-gray-100 px-4 rounded-lg pointer-events-none outline-none",children:e.jsx(_,{className:"text-black text-2xl"})})]}),e.jsx("p",{className:"text-red-700",children:m})]}),h=({label:d,register:p,name:t,options:n,error:m,watchValue:l})=>e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("p",{className:"text-lg",children:[d," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("div",{className:"flex flex-col space-y-1",children:n.map(c=>{const b=`${t}-${c.value}`;return e.jsxs("div",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{...p(t),type:"radio",id:b,value:c.value,className:"hidden peer"}),e.jsxs("label",{htmlFor:b,className:"flex items-center cursor-pointer",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-gray-400 rounded-sm flex items-center justify-center peer-checked:border-blue-500 peer-checked:bg-blue-500",children:e.jsx("span",{className:`w-3 h-3 ${l===c.value?"bg-white":"hidden"}`})}),e.jsx("span",{className:"ml-2",children:c.label})]})]},c.value)})}),e.jsx("p",{className:"text-red-700",children:m})]}),le=()=>{var P,q,S,C,A,G,I,z,Y,T,$,V;const[d,p]=g.useState([]),[t,n]=g.useState(!1),[m,l]=g.useState([]),[c,b]=g.useState(!0),w=J(),N=(P=K().state)==null?void 0:P.userId;console.log(N);const{register:s,handleSubmit:D,watch:x,setValue:i,reset:re,formState:{errors:r}}=W({resolver:Z(ae)}),E=x("subtopic"),O=x("coursetype"),L=x("preGenerated"),Q=x("studyGroup"),B=x("quizAccess");g.useEffect(()=>{H(),M()},[]);const H=async()=>{try{const a=await v.get(`${f}/api/gettax`);Array.isArray(a.data.tax)?l(a.data.tax):l([])}catch{l([])}},M=async()=>{try{const a=await v.get(`${f}/api/subscriptionplan/${N}`),j=a.data.plan;p(j);const u=a.data.plan;i("packagename",u.packagename),i("duration",u.duration),i("price",u.price),i("inr",u.inr),i("course",u.course),i("tax",u.tax),i("subtopic",u.subtopic),i("coursetype",u.coursetype)}catch{k.error("Failed to load package data")}finally{b(!1)}},U=async a=>{n(!0);try{(await v.put(`${f}/api/subscriptionplan/${N}`,{...a,packagename:a.packagename.toLowerCase()})).status===200&&(k.success("Package updated successfully"),w("/packages"))}catch{k.error("Failed to update package")}finally{n(!1)}};return c?e.jsx("div",{className:"p-8",children:"Loading..."}):e.jsxs("div",{className:"mx-6 my-8 font-poppins h-full",children:[e.jsx("p",{className:"mb-2",children:"Edit Package"}),e.jsxs("form",{onSubmit:D(U),className:"mx-4 my-6",children:[e.jsxs("div",{className:"mx-6 grid gap-12 font-extralight my-8",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-6 items-center",children:[e.jsx(y,{label:"Package Name",register:s,name:"packagename",placeholder:"Enter Package name",error:(q=r.packagename)==null?void 0:q.message}),e.jsx(R,{label:"Plan Renewal",register:s,name:"duration",options:[{value:"monthly",label:"Monthly"},{value:"quarterly",label:"Quarterly"},{value:"halfYearly",label:"Half-Yearly"},{value:"annual",label:"Annual"}],error:(S=r.duration)==null?void 0:S.message}),e.jsx(y,{label:"Package Price INR",register:s,name:"inr",placeholder:"Enter Price In INR",error:(C=r.inr)==null?void 0:C.message})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center",children:[e.jsx(y,{label:"No of Courses",register:s,name:"course",type:"number",placeholder:"00",error:(A=r.course)==null?void 0:A.message}),e.jsx(R,{label:"Tax",register:s,name:"tax",options:m.map(a=>({value:a.percentage,label:`${a.percentage}%`})),error:(G=r.tax)==null?void 0:G.message}),e.jsx(y,{label:"Razorpay ID",register:s,name:"razorpay",placeholder:"Enter Razorpay ID",defaultValue:"N/A",error:(I=r.razorpay)==null?void 0:I.message})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-4 items-center",children:[e.jsx(h,{label:"No of Subtopic",register:s,name:"subtopic",options:[{value:"5",label:"05"},{value:"10",label:"10"}],error:(z=r.subtopic)==null?void 0:z.message,watchValue:E}),e.jsx(h,{label:"Course Type",register:s,name:"coursetype",options:[{value:"Text & Image Course",label:"Theory & Image Course"},{value:"Video & Text Course",label:"Video & Theory Course"}],error:(Y=r.coursetype)==null?void 0:Y.message,watchValue:O}),e.jsx(h,{label:"Pre-Generated Courses",register:s,name:"preGenerated",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],error:(T=r.preGenerated)==null?void 0:T.message,watchValue:L}),e.jsx(h,{label:"Study Group",register:s,name:"studyGroup",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],error:($=r.studyGroup)==null?void 0:$.message,watchValue:Q}),e.jsx(h,{label:"Quiz Access",register:s,name:"quizAccess",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],error:(V=r.quizAccess)==null?void 0:V.message,watchValue:B})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{type:"submit",className:`my-6 text-white bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] px-8 py-1.5 rounded-md ${t?"opacity-50 cursor-not-allowed":""}`,disabled:t,children:t?e.jsxs("div",{className:"flex text-xl gap-2",children:[e.jsx(X,{className:"h-6 w-6 animate-spin"}),e.jsx("p",{children:"Saving...."})]}):"Update"}),e.jsx("button",{type:"button",onClick:()=>w("/packages"),className:"cursor-pointer text-black bg-white py-1.5 px-4 rounded-md",children:"Cancel"})]})]})]})};export{le as default};
