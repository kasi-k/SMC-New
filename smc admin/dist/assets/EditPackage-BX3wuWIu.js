import{r as g,u as J,n as K,a as W,b as v,c as f,y as k,j as e,A as X,o as Z,F as _,d as ee,e as i,m as F}from"./index-DgKZBfYf.js";const se=ee().shape({paymentId:i().trim().required("Razorpay ID is required"),packagename:i().trim().required("Package name is required"),duration:i().trim().required("Plan Duration is required"),inr:F().required("Price in INR required"),course:i().trim().required("Courses are required"),tax:F().required("Tax is required"),subtopic:i().oneOf(["5","10"],"Please select a valid number of subtopics").required("Please select the number of subtopics"),coursetype:i().oneOf(["Text & Image Course","Video & Text Course"],"Please select a valid course type").required("Please select the course type"),preCourses:i().oneOf(["Yes","No"],"Please select Yes or No for Pre-Generated Courses").required("Pre-Generated Courses selection is required"),studyGroupAccess:i().oneOf(["Yes","No"],"Please select Yes or No for Study Group").required("Study Group selection is required"),quizAccess:i().oneOf(["Yes","No"],"Please select Yes or No for Quiz Access").required("Quiz Access selection is required")}),y=({label:d,register:p,name:c,type:u="text",error:m,...o})=>e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("label",{className:"text-lg",children:[d," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{...p(c),type:u,className:"bg-white outline-none text-black rounded-md py-1.5 px-2",...o}),e.jsx("p",{className:"text-red-700",children:m})]}),R=({label:d,register:p,name:c,options:u,error:m})=>e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("label",{className:"text-lg",children:[d," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative ",children:[e.jsxs("select",{defaultValue:"",...p(c),className:"w-full bg-white outline-none text-black rounded-md py-2 px-2",children:[e.jsxs("option",{value:"",disabled:!0,children:["Select ",d]}),u.map((o,n)=>e.jsx("option",{value:o.value,children:o.label},n))]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-5 bg-gray-100 px-4 rounded-lg pointer-events-none outline-none",children:e.jsx(_,{className:"text-black text-2xl"})})]}),e.jsx("p",{className:"text-red-700",children:m})]}),h=({label:d,register:p,name:c,options:u,error:m,watchValue:o})=>e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("p",{className:"text-lg",children:[d," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("div",{className:"flex flex-col space-y-1",children:u.map(n=>{const b=`${c}-${n.value}`;return e.jsxs("div",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{...p(c),type:"radio",id:b,value:n.value,className:"hidden peer"}),e.jsxs("label",{htmlFor:b,className:"flex items-center cursor-pointer",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-gray-400 rounded-sm flex items-center justify-center peer-checked:border-blue-500 peer-checked:bg-blue-500",children:e.jsx("span",{className:`w-3 h-3 ${o===n.value?"bg-white":"hidden"}`})}),e.jsx("span",{className:"ml-2",children:n.label})]})]},n.value)})}),e.jsx("p",{className:"text-red-700",children:m})]}),le=()=>{var w,P,A,C,I,S,G,Y,z,T,$,V;const[d,p]=g.useState([]),[c,u]=g.useState(!1),[m,o]=g.useState([]),[n,b]=g.useState(!0),q=J(),N=(w=K().state)==null?void 0:w.userId;console.log(N);const{register:t,handleSubmit:D,watch:x,setValue:a,reset:re,formState:{errors:l}}=W({resolver:Z(se)}),E=x("subtopic"),O=x("coursetype"),L=x("preCourses"),Q=x("studyGroupAccess"),B=x("quizAccess");g.useEffect(()=>{H(),M()},[]);const H=async()=>{try{const s=await v.get(`${f}/api/gettax`);Array.isArray(s.data.tax)?o(s.data.tax):o([])}catch{o([])}},M=async()=>{try{const s=await v.get(`${f}/api/getsubscriptionplanbyid/${N}`);console.log(s);const j=s.data.plan;p(j);const r=s.data.plan;a("packagename",r.packagename),a("paymentId",r.paymentId),a("duration",r.duration),a("price",r.price),a("inr",r.inr),a("course",r.course),a("tax",r.tax),a("subtopic",r.subtopic),a("coursetype",r.coursetype),a("preCourses",r.preCourses),a("studyGroupAccess",r.studyGroupAccess),a("quizAccess",r.quizAccess)}catch{k.error("Failed to load package data")}finally{b(!1)}},U=async s=>{u(!0);try{(await v.put(`${f}/api/subscriptionplan/${N}`,{...s,packagename:s.packagename.toLowerCase()})).status===200&&(k.success("Package updated successfully"),q("/packages"))}catch{k.error("Failed to update package")}finally{u(!1)}};return n?e.jsx("div",{className:"p-8",children:"Loading..."}):e.jsxs("div",{className:"mx-6 my-8 font-poppins h-full",children:[e.jsx("p",{className:"mb-2",children:"Edit Package"}),e.jsxs("form",{onSubmit:D(U),className:"mx-4 my-6",children:[e.jsxs("div",{className:"mx-6 grid gap-12 font-extralight my-8",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-6 items-center",children:[e.jsx(y,{label:"Package Name",register:t,name:"packagename",placeholder:"Enter Package name",error:(P=l.packagename)==null?void 0:P.message}),e.jsx(R,{label:"Plan Renewal",register:t,name:"duration",options:[{value:"monthly",label:"Monthly"},{value:"quarterly",label:"Quarterly"},{value:"halfYearly",label:"Half-Yearly"},{value:"annual",label:"Annual"}],error:(A=l.duration)==null?void 0:A.message}),e.jsx(y,{label:"Package Price INR",register:t,name:"inr",placeholder:"Enter Price In INR",error:(C=l.inr)==null?void 0:C.message})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center",children:[e.jsx(y,{label:"No of Courses",register:t,name:"course",type:"number",placeholder:"00",error:(I=l.course)==null?void 0:I.message}),e.jsx(R,{label:"Tax",register:t,name:"tax",options:m.map(s=>({value:s.percentage,label:`${s.percentage}%`})),error:(S=l.tax)==null?void 0:S.message}),e.jsx(y,{label:"Razorpay ID",register:t,name:"paymentId",placeholder:"Enter Razorpay ID",error:(G=l.paymentId)==null?void 0:G.message})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-4 items-center",children:[e.jsx(h,{label:"No of Subtopic",register:t,name:"subtopic",options:[{value:"5",label:"05"},{value:"10",label:"10"}],error:(Y=l.subtopic)==null?void 0:Y.message,watchValue:E}),e.jsx(h,{label:"Course Type",register:t,name:"coursetype",options:[{value:"Text & Image Course",label:"Theory & Image Course"},{value:"Video & Text Course",label:"Video & Theory Course"}],error:(z=l.coursetype)==null?void 0:z.message,watchValue:O}),e.jsx(h,{label:"Pre-Generated Courses",register:t,name:"preCourses",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],error:(T=l.preCourses)==null?void 0:T.message,watchValue:L}),e.jsx(h,{label:"Study Group",register:t,name:"studyGroupAccess",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],error:($=l.studyGroupAccess)==null?void 0:$.message,watchValue:Q}),e.jsx(h,{label:"Quiz Access",register:t,name:"quizAccess",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],error:(V=l.quizAccess)==null?void 0:V.message,watchValue:B})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{type:"submit",className:`my-6 text-white bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] px-8 py-1.5 rounded-md ${c?"opacity-50 cursor-not-allowed":""}`,disabled:c,children:c?e.jsxs("div",{className:"flex text-xl gap-2",children:[e.jsx(X,{className:"h-6 w-6 animate-spin"}),e.jsx("p",{children:"Saving...."})]}):"Update"}),e.jsx("button",{type:"button",onClick:()=>q("/packages"),className:"cursor-pointer text-black bg-white py-1.5 px-4 rounded-md",children:"Cancel"})]})]})]})};export{le as default};
